<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${subjectName} + ' - Classroom'">Classroom</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        .classroom-hero {
            background: linear-gradient(135deg, var(--eac-maroon) 0%, #8f1a2e 100%);
            color: #fff;
            border-radius: 14px;
            padding: 2rem 2.5rem;
            margin-bottom: 1.75rem;
        }
        .classroom-hero h2 { font-weight: 700; }
        .classroom-hero .meta-chip {
            display: inline-flex; align-items: center; gap: 0.35rem;
            background: rgba(255,255,255,0.15); border-radius: 30px;
            padding: 0.2rem 0.75rem; font-size: 0.85rem;
        }
        .section-title {
            color: var(--eac-maroon); font-weight: 700;
            border-bottom: 2px solid var(--eac-gold);
            padding-bottom: 0.4rem; margin-bottom: 1.25rem;
        }
        .exam-card {
            border: 1px solid var(--eac-border);
            border-radius: 12px;
            overflow: hidden;
            transition: box-shadow 0.2s;
        }
        .exam-card:hover { box-shadow: 0 6px 20px rgba(122,16,34,0.12); }
        .exam-card-header {
            background: linear-gradient(135deg, var(--eac-maroon), #8f1a2e);
            color: #fff;
            padding: 1rem 1.25rem;
        }
        .exam-card-header .activity-type-badge {
            background: rgba(255,255,255,0.2);
            color: #fff;
            border-radius: 20px;
            padding: 0.15rem 0.65rem;
            font-size: 0.78rem;
        }
        .deadline-warning { color: #dc3545; font-size: 0.82rem; }
        .badge-score { font-size: 0.83rem; }
        .hist-thead { background: var(--eac-maroon); color: #fff; }
        .submission-notification-card {
            border: 1px solid var(--eac-border);
            border-radius: 12px;
            background: #fff;
            padding: 1.25rem;
        }
        .notif-wrap {
            display: inline-flex;
            align-items: center;
            gap: 0.7rem;
        }
        .notif-dot {
            width: 34px;
            height: 34px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: #b02a37;
            color: #fff;
            font-weight: 700;
            font-size: 0.9rem;
        }
    </style>
</head>
<body class="homepage-page">

<div class="teacher-layout">
    <div th:replace="~{student-nav :: studentNav}"></div>

    <div class="teacher-content-wrapper">
        <div class="container" style="max-width:1100px;">

            <div class="mb-3">
                <a th:href="@{/student/dashboard}" class="btn btn-sm btn-light">
                    <i class="bi bi-arrow-left me-1"></i>Back to Dashboard
                </a>
            </div>

            <div class="classroom-hero">
                <div class="d-flex flex-wrap justify-content-between align-items-start gap-3">
                    <div>
                        <h2 class="mb-1">
                            <i class="bi bi-book me-2"></i>
                            <span th:text="${subjectName}">Subject Name</span>
                        </h2>
                        <p class="mb-3 opacity-75" th:text="${subjectDescription != null && !#strings.isEmpty(subjectDescription) ? subjectDescription : 'No description provided.'}">Description</p>
                        <div class="d-flex flex-wrap gap-2">
                            <span class="meta-chip">
                                <i class="bi bi-person"></i>
                                <span th:text="${teacherEmail}">teacher@email.com</span>
                            </span>
                            <span class="meta-chip">
                                <i class="bi bi-file-earmark-text"></i>
                                <span th:text="${submissionCount} + ' submission(s)'"></span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-4">
                <h5 class="section-title"><i class="bi bi-hourglass-split me-2"></i>Available Exams</h5>

                <div th:if="${#lists.isEmpty(pendingExams)}" class="text-center py-4">
                    <div class="card upload-card p-4">
                        <i class="bi bi-calendar-x" style="font-size: 3rem; color: #ccc;"></i>
                        <h6 class="mt-3 text-muted">No Exam Available</h6>
                        <p class="text-muted small mb-0">Your teacher hasn't distributed an exam for this subject yet.</p>
                    </div>
                </div>

                <div th:if="${!#lists.isEmpty(pendingExams)}" class="row g-3">
                    <div class="col-12 col-md-8 col-lg-6" th:each="pendingExam : ${pendingExams}">
                        <div class="exam-card shadow-sm">
                            <div class="exam-card-header">
                                <div class="d-flex justify-content-between align-items-start">
                                    <h6 class="mb-1 fw-bold" th:text="${pendingExam.name}">Exam Name</h6>
                                    <span class="activity-type-badge" th:text="${pendingExam.type}">Type</span>
                                </div>
                            </div>
                            <div class="card-body p-3">
                                <div class="d-flex flex-wrap gap-3 mb-3">
                                    <div class="text-muted small">
                                        <i class="bi bi-question-circle me-1"></i>
                                        <span th:text="${pendingExam.questionCount}">0</span> questions
                                    </div>
                                    <div class="text-muted small">
                                        <i class="bi bi-clock me-1"></i>
                                        <span th:text="${pendingExam.timeLimit}">0</span> min
                                    </div>
                                    <div th:if="${pendingExam.deadline != null && !#strings.isEmpty(pendingExam.deadline)}"
                                         class="deadline-warning">
                                        <i class="bi bi-calendar-event me-1"></i>
                                        Due: <span th:text="${pendingExam.deadline}">Deadline</span>
                                    </div>
                                </div>
                                <a th:href="${pendingExam.startUrl}" class="btn btn-primary w-100">
                                    <i class="bi bi-play-circle me-1"></i>Take Exam
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-5">
                <h5 class="section-title"><i class="bi bi-clock-history me-2"></i>Exam History</h5>

                <div th:if="${!hasHistory}" class="text-center py-4">
                    <div class="card upload-card p-4">
                        <i class="bi bi-inbox" style="font-size: 3rem; color: #ccc;"></i>
                        <h6 class="mt-3 text-muted">No Submissions Yet</h6>
                        <p class="text-muted small mb-0">Completed exams for this subject will appear here.</p>
                    </div>
                </div>

                <div th:if="${hasHistory}" class="submission-notification-card shadow-sm text-center">
                    <div class="notif-wrap">
                        <span class="notif-dot" th:text="${submissionCount}">0</span>
                        <div class="text-start">
                            <div class="fw-semibold text-danger">Submitted exams</div>
                            <small class="text-muted">Use dashboard history to view full details.</small>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
